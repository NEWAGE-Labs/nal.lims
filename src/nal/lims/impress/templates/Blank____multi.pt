<!--
AUTHOR:   Paul VanderWeele
DATE:     05/11/2021
PURPOSE:  HP-01 Report for NEWAGE LIMS
EDITS:
 -->

 <!-- BEGIN Variables -->
<tal:report
  condition="python:True"
  i18n:domain="senaite.impress"
  define="collection view/collection;
          laboratory view/laboratory;
          reporter python:view.current_user;
          accredited_symbol string:*;
          outofrange_symbol string:âš ;
          footer python:view.get_footer_text();
          report_options python:options.get('report_options', {});
          attachments_per_row python:int(report_options.get('attachments_per_row', 2));
          attachments_per_row python:attachments_per_row<1 and 1 or attachments_per_row;
          page_width options/page_width|nothing;
          page_height options/page_height|nothing;
          content_width options/content_width|nothing;
          content_height options/content_height|nothing;
          letterhead python:view.get_resource_url('++plone++nal.lims/images/default_letterhead.png')">
 <!-- END Variables -->
  <!-- BEGIN Custom Report Controls -->
  <div id="controls" class="noprint">
    <div i18n:translate="" class="text-secondary mb-2">Custom Report Options</div>
    <div class="mb-3">
      <!-- BEGIN Attachments per row -->
      <div class="input-group">
        <div class="input-group-prepend">
          <label class="input-group-text" for="attachments_per_row" i18n:translate="">
            Attachments per Row
          </label>
        </div>
        <input tal:attributes="value attachments_per_row"
               type="number"
               class="form-control"
               name="attachments_per_row"
               min="1"/>
      </div>
      <!-- END Attachments per row -->
      <small class="form-text text-muted" i18n:translate="">
        Number of attachments rendered within one row per Analysis Request
      </small>
    </div>
  </div>
  <!-- END Custom Report Controls -->
  <!-- BEGIN Ensure custom report options are applied to rendering -->
  <script type="text/javascript">
   console.info("######################################################################");
   window.options = "<tal:t replace='options'/>";
   console.log(window.options);
   console.info("######################################################################");
  </script>
  <!-- END Ensure custom report options are applied to rendering -->

  <!-- BEGIN CSS Styling -->
  <tal:css>
    <style type="text/css">
      div.cover-page {height: 792pt;}
      div.cover-letter {margin-left: -60pt; margin-top: -60pt; height: 792pt; width: 612pt; background-size: 100% 100%; background-image: url(<tal:bg replace="letterhead"/>);}
      div.cover-body {font-size: 8pt; padding-top: 140pt; padding-left: 40pt; width: 570pt;}
      div.cover-date {font-weight: bold;}
      div.cover-client {font-weight: bold;}
      div.cover-client-contact {font-weight: bold;}
      span.cover-subject-header {font-weight: bold;}
      div.blank-page {height: 792pt;}
      img.coc {height: 792pt; margin-left: -40pt; margin-top: -45pt;}
      div.blank-page-background {margin-left: -60pt; margin-top: -60pt; height: 792pt; width: 612pt; background-size: 100% 100%; background-image: url(<tal:bg replace="letterhead"/>);}
      h4.blank-text {margin-left: 150pt; padding-top: 370pt;}
      td.president-sig img {width: 150pt;}
      td.vp-sig img {width: 150pt;}
      td.president-title {vertical-align: top;}
      td.vp-title {vertical-align: top;}

      @page {
        @bottom-left {
          font-size: 5pt;
          margin-bottom: -20pt;
          content: "<tal:t i18n:translate=''>Page</tal:t> " counter(page) " <tal:t i18n:translate=''>of</tal:t> " counter(pages);
        }
      }
    </style>
  </tal:css>
  <!-- END CSS Styling -->
  <!-- BEING Cover Letter -->
  <div class="cover-page" tal:define="model python:view.get_one_model(collection); pages python:view.get_sap_report_count(collection);">
    <div class="cover-letter">
      <div class="cover-body">
        <div class="cover-date">
          <tal:date replace="python:view.get_today()"/>
        </div>
        <br>
        <div class="cover-client">
          <div class="cover-client-name">
            <div tal:replace="model/Client/Name|nothing"></div>
          </div>
          <div class="cover-client-address">
            <div tal:replace="model/Client/PostalAddress/address|nothing"></div>
          </div>
          <div class="cover-client-city">
            <div tal:replace="model/Client/PostalAddress/city|nothing"></div>
          </div>
          <div class="cover-client-statezip">
          <span class="client-state">
            <div tal:replace="model/Client/PostalAddress/state|nothing"></div>
          </span>
          <span class="client-zip">
            <div tal:replace="model/Client/PostalAddress/zip|nothing"></div>
          </span>
          </div>
          <br>
          <div class="cover-client-contact">
            <span>ATTN: </span>
            <span tal:content="python:model.get_project_contact()"></span>
          </div>
        </div>
        <br>
        <div class="cover-subject">
          <span class="cover-subject-header">SUBJECT: </span>
          <span>Sample Delivery Group</span>
          <span tal:content="model/Batch/Title|nothing"></span>
          <!-- <span tal:content="model/Batch/Project|nothing"></span> -->
        </div>
        <br>
        <div class="cover-salutation">
          <div>
            <span>Dear</span>
            <span tal:replace="python:model.get_project_contact()"></span>
            <span>,</span>
          </div>
        </div>
        <br>
        <div class="cover-first-paragraph">
          The following is the final report containing the analytical result for the plant sap samples delivered on <tal:date replace="python:model.get_received_date()"/>. The report consists of <tal:pages replace="pages"/> pages inclusive of all sample results, chain of custodies, and this cover letter.
        </div>
        <br>
        <div class="cover-second-paragraph">
          All samples were analyzed in accordance with the parameters outline on the chain of custody records and the oral and/or written correspondence between yourself and NEW AGE Laboratories. NEW AGE certifies that, to our best knowledge, this data package is in compliance with the terms and conditions of the contract, both technically and for completeness, and that test results meet all requirements of NEW AGE's Quality Assurance Manual. NEW AGE is an ISO/IEC 17025:2017 certified laboratory and meets the requiremnts of the AOAC International Guidelines for Laboratories Performing Microbiological and Chemical Analyses of Food and Pharmaceutical-2010 and APLAC TC 007 Guidelines for Food Testing Laboratories.
        </div>
        <br>
        <div class="cover-third-paragraph">
          Please review the report and contact our office if you have any questions or need additional information. Thank you for choosing NEW AGE Laboratories for this important project. We look forward to working with you again in the future.
        </div>
        <br>
        <div class="cover-sincerely">
          <div>Sincerely,</div>
          <div><strong>NEW AGE Laboratories</strong></div>
        </div>
        <br>
        <div class="cover-presidents">
          <table>
            <colgroup>
              <col style="width: 65%;">
            </colgroup>
            <tr class="president-signatures">
              <td class="president-sig">
                <img tal:attributes="src python:view.get_resource_url('++plone++nal.lims/images/pres_signature.png')"/>
              </td>
              <td class="vp-sig">
                <img tal:attributes="src python:view.get_resource_url('++plone++nal.lims/images/vp_signature.png')"/>
              </td>
            </tr>
            <tr class="president-names">
              <td class="president-name">
                <div>Scott D. Wall</div>
              </td>
              <td class="vp-name">
                <div>Irish L. Gallagher</div>
              </td>
            </tr>
            <tr class="president-titles">
              <td class="president-title">
                <div>President</div>
              </td>
              <td class="vp-title">
                <div>Vice President of Laboratory Operations</div>
              </td>
            </tr>
          </table>
        </div>
        <br>
        <div class="cover-pjla">
          <div style="font-size: 6pt;">Parameters marked with an astrisk <tal:acc replace="accredited_symbol"/> are <strong>not</strong> accredited under our ISO/IEC 17025:2017 scope</div>
          <img style="height: 120px;" tal:attributes="src python:view.get_resource_url('++plone++nal.lims/images/pjla.png')"/>
        </div>
      </div>
    </div>
  </div>
  <!-- END Cover Letter -->
  <!-- BEGIN Blank Page-->
  <div class="blank-page">
    <div class="blank-page-background">
      <h4 class="blank-text">This Page Is Intentionally Left Blank</h4>
    </div>
  </div>
  <!-- END Blank Page-->
  <!-- BEGIN Result Pages-->



  <!-- END of Result Pages -->
  <!--BEGIN Attachments -->
  <tal:model repeat="model collection">
    <tal:check condition="model/Attachment">
      <tal:attachment define="attachment python:model.get_attachment_file()">
        <figure class="figure">
          <img class="coc figure-img img-fluid"
              tal:attributes="src string:${attachment/absolute_url}/AttachmentFile;"></img>
        </figure>
      </tal:attachment>
    </tal:check>
  </tal:model>
  <!--END Attachments -->
</tal:report>
